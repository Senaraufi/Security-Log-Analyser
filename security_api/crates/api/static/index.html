<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Analysis Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --neutral-50: #fafafa;
            --neutral-100: #f5f5f5;
            --neutral-300: #d4d4d4;
            --neutral-400: #a3a3a3;
            --neutral-500: #737373;
            --neutral-600: #525252;
            --neutral-700: #404040;
            --neutral-800: #262626;
            --neutral-900: #171717;
            --neutral-950: #0a0a0a;
            
            --cyan-400: #22d3ee;
            --cyan-500: #06b6d4;
            
            --purple-400: #c084fc;
            --purple-500: #a855f7;
            --purple-950: #3b0764;
            
            --red-400: #f87171;
            --orange-400: #fb923c;
            --yellow-400: #facc15;
            --green-400: #4ade80;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            line-height: 1.5;
        }

        /* Header */
        .header {
            border-bottom: 1px solid #1a1a1a;
            padding: 1.25rem 2rem;
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .logo-icon {
            width: 24px;
            height: 24px;
            color: var(--cyan-500);
        }
        
        .header-title-text {
            font-size: 0.9375rem;
            font-weight: 400;
            color: #ffffff;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .back-button {
            background: none;
            border: none;
            color: var(--neutral-400);
            cursor: pointer;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            transition: color 0.2s;
        }

        .back-button:hover {
            color: var(--neutral-100);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 4rem 1.5rem;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        /* Landing Page */
        .landing-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .landing-header h1 {
            font-size: 2.25rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .landing-header p {
            color: var(--neutral-400);
            max-width: 42rem;
            margin: 0 auto;
        }

        .mode-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .mode-card {
            position: relative;
            background: #0f0f0f;
            border: 1px solid #262626;
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mode-card:hover {
            border-color: #404040;
            transform: translateY(-2px);
        }

        .mode-card.ai-mode {
            background: linear-gradient(135deg, rgba(107, 33, 168, 0.05) 0%, #0f0f0f 100%);
            border-color: #6b21a8;
        }

        .mode-card.ai-mode:hover {
            border-color: #7c3aed;
        }

        .mode-icon {
            width: 3rem;
            height: 3rem;
            background: rgba(34, 211, 238, 0.1);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .mode-card.ai-mode .mode-icon {
            background: rgba(168, 85, 247, 0.1);
        }

        .mode-card h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .mode-card p {
            color: var(--neutral-400);
            margin-bottom: 1.5rem;
        }

        .feature-list {
            list-style: none;
            margin-bottom: 1.5rem;
        }

        .feature-list li {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--neutral-500);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .mode-footer {
            padding-top: 1.5rem;
            border-top: 1px solid var(--neutral-800);
            color: var(--neutral-500);
            font-size: 0.875rem;
        }

        .mode-card.ai-mode .mode-footer {
            border-top-color: rgba(168, 85, 247, 0.2);
        }

        /* File Upload */
        .file-upload {
            background: var(--neutral-900);
            border: 1px solid var(--neutral-800);
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .upload-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .upload-button {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border: 1px solid var(--neutral-700);
            background: var(--neutral-800);
            color: var(--neutral-300);
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .upload-button:hover {
            background: var(--neutral-750);
            border-color: var(--neutral-600);
        }

        .upload-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--cyan-400);
        }

        .status-dot {
            width: 0.5rem;
            height: 0.5rem;
            background: var(--cyan-400);
            border-radius: 50%;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .metric-card {
            background: var(--neutral-900);
            border: 1px solid var(--neutral-800);
            padding: 1rem;
            border-radius: 0.5rem;
            transition: border-color 0.2s;
        }

        .metric-card:hover {
            border-color: var(--neutral-700);
        }

        .metric-header {
            display: flex;
            align-items: flex-start;
            justify-between;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-variant-numeric: tabular-nums;
        }

        .metric-label {
            color: var(--neutral-400);
            font-size: 0.875rem;
        }

        .metric-change {
            font-size: 0.75rem;
            color: var(--cyan-400);
        }

        /* Section */
        .section {
            background: var(--neutral-900);
            border: 1px solid var(--neutral-800);
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-between;
            padding: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .section-header:hover {
            background: var(--neutral-800);
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-content {
            border-top: 1px solid var(--neutral-800);
            padding: 1rem;
            display: none;
        }

        .section-content.expanded {
            display: block;
        }

        /* Risk Indicator */
        .risk-indicator {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
        }

        .risk-indicator.low {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid rgba(74, 222, 128, 0.3);
            color: var(--green-400);
        }
        
        .risk-indicator.medium {
            background: rgba(250, 204, 21, 0.1);
            border: 1px solid rgba(250, 204, 21, 0.3);
            color: var(--yellow-400);
        }

        .risk-indicator.high {
            background: rgba(251, 146, 60, 0.1);
            border: 1px solid rgba(251, 146, 60, 0.3);
            color: var(--orange-400);
        }

        .risk-indicator.critical {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid rgba(248, 113, 113, 0.3);
            color: var(--red-400);
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
        }

        .icon-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--neutral-400);
        }

        .spinner {
            width: 3rem;
            height: 3rem;
            border: 3px solid var(--neutral-800);
            border-top-color: var(--cyan-400);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Footer */
        .footer {
            padding: 1.5rem 2rem;
            text-align: center;
            border-top: 1px solid #1a1a1a;
            margin-top: auto;
        }
        
        .footer-text {
            font-size: 0.8125rem;
            color: #525252;
        }
        
        .trademark {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: #404040;
        }
        
        /* Help Button */
        .help-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #1a1a1a;
            border: 1px solid #262626;
            color: #a3a3a3;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        
        .help-button:hover {
            background: #262626;
            border-color: #404040;
        }
        
        #landing-page {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landing-page">
        <div class="header">
            <div class="header-content">
                <div class="header-title">
                    <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                    </svg>
                    <span>Cybersecurity Analysis Platform</span>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="landing-header">
                <h1>Select Analysis Method</h1>
                <p>Choose your preferred log analysis approach. Standard analysis provides comprehensive threat detection, while AI-powered analysis leverages Groq AI for advanced pattern recognition and insights.</p>
            </div>

            <div class="mode-grid">
                <!-- Standard Analysis -->
                <div class="mode-card" onclick="selectMode('standard')">
                    <div class="mode-icon">
                        <svg class="icon" fill="none" stroke="var(--cyan-400)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                        </svg>
                    </div>
                    <h2>Analyse Logs</h2>
                    <p>Traditional log analysis with real-time threat detection, IP reputation checks, and comprehensive parsing statistics. Ideal for standard security operations.</p>
                    <ul class="feature-list">
                        <li>
                            <svg class="icon-sm" fill="none" stroke="var(--cyan-400)" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                            </svg>
                            <span>Fast processing</span>
                        </li>
                        <li>
                            <svg class="icon-sm" fill="none" stroke="var(--cyan-400)" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                            </svg>
                            <span>Pattern-based detection</span>
                        </li>
                        <li>
                            <svg class="icon-sm" fill="none" stroke="var(--cyan-400)" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                            </svg>
                            <span>Structured reporting</span>
                        </li>
                    </ul>
                    <div class="mode-footer">
                        Best for routine analysis
                    </div>
                </div>

                <!-- AI-Powered Analysis -->
                <div class="mode-card ai-mode" onclick="selectMode('ai')">
                    <div class="mode-icon">
                        <svg class="icon" fill="none" stroke="var(--purple-400)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
                        </svg>
                    </div>
                    <h2>
                        Analyse Logs with AI
                        <svg class="icon-sm" fill="none" stroke="var(--purple-400)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
                        </svg>
                    </h2>
                    <p>AI-powered log analysis using Groq AI (Llama 3.1 70B) for advanced threat intelligence, contextual insights, and natural language explanations of security events.</p>
                    <ul class="feature-list">
                        <li>
                            <svg class="icon-sm" fill="none" stroke="var(--purple-400)" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
                            </svg>
                            <span>Advanced pattern recognition</span>
                        </li>
                        <li>
                            <svg class="icon-sm" fill="none" stroke="var(--purple-400)" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
                            </svg>
                            <span>Contextual insights</span>
                        </li>
                        <li>
                            <svg class="icon-sm" fill="none" stroke="var(--purple-400)" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                            </svg>
                            <span>Natural language reports</span>
                        </li>
                    </ul>
                    <div class="mode-footer">
                        Best for complex investigations
                    </div>
                </div>
            </div>

            <div class="footer">
                <div class="footer-text">SOC Analyst Dashboard â€¢ Real-time Threat Detection â€¢ Enterprise Grade Security</div>
                <div class="trademark">Â© 2025 Senaraufi. All rights reserved.</div>
            </div>
        </div>
        
        <button class="help-button" onclick="alert('Help documentation coming soon!')">?</button>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard-page" class="hidden">
        <div class="header">
            <div class="header-content">
                <div class="header-left">
                    <button class="back-button" onclick="backToLanding()">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                        </svg>
                    </button>
                    <div class="header-title">
                        <svg class="icon" fill="none" stroke="var(--cyan-400)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                        </svg>
                        <span id="dashboard-title">Cybersecurity Analysis Dashboard</span>
                    </div>
                </div>
                <div id="risk-indicator-container"></div>
            </div>
        </div>

        <div class="dashboard-container">
            <!-- File Upload -->
            <div class="file-upload">
                <div class="upload-content">
                    <label class="upload-button">
                        <input type="file" id="file-input" accept=".log,.txt" style="display: none;">
                        <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" />
                        </svg>
                        <span id="file-name">Upload Log File</span>
                    </label>
                    <div id="upload-status" class="upload-status hidden">
                        <div class="status-dot"></div>
                        <span>Analyzed</span>
                    </div>
                </div>
            </div>

            <!-- Loading -->
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Analyzing security logs...</p>
            </div>

            <!-- Results -->
            <div id="results" class="hidden">
                <!-- Metrics -->
                <div class="metrics-grid" id="metrics-grid"></div>

                <!-- AI Results Section -->
                <div id="ai-results-section" class="section hidden">
                    <div class="section-header" onclick="toggleSection('ai-results')">
                        <div class="section-title">
                            <span>â–¼</span>
                            <span>ðŸ¤– Groq AI Security Analysis</span>
                        </div>
                    </div>
                    <div class="section-content expanded" id="ai-results-content"></div>
                </div>

                <!-- Threat Distribution -->
                <div class="section">
                    <div class="section-header" onclick="toggleSection('threats')">
                        <div class="section-title">
                            <span id="threats-chevron">â–¶</span>
                            <span>Threat Distribution</span>
                            <span style="color: var(--neutral-400);" id="threats-count">0 Total</span>
                        </div>
                    </div>
                    <div class="section-content" id="threats-content"></div>
                </div>

                <!-- IP Analysis -->
                <div class="section">
                    <div class="section-header" onclick="toggleSection('ips')">
                        <div class="section-title">
                            <span id="ips-chevron">â–¶</span>
                            <span>IP Analysis</span>
                            <span style="color: var(--neutral-400);" id="ips-count">0 IPs</span>
                        </div>
                    </div>
                    <div class="section-content" id="ips-content"></div>
                </div>
                
                <!-- Parsing Statistics -->
                <div class="section">
                    <div class="section-header" onclick="toggleSection('parsing')">
                        <div class="section-title">
                            <span id="parsing-chevron">â–¶</span>
                            <span>Parsing Statistics</span>
                        </div>
                    </div>
                    <div class="section-content" id="parsing-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentMode = null;
        let currentFile = null;

        // Security: Sanitize HTML to prevent XSS attacks
        function escapeHtml(unsafe) {
            if (typeof unsafe !== 'string') {
                return unsafe;
            }
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('dashboard-page').classList.remove('hidden');
            
            if (mode === 'ai') {
                document.getElementById('dashboard-title').textContent = 'AI-Powered Analysis Dashboard';
            } else {
                document.getElementById('dashboard-title').textContent = 'Cybersecurity Analysis Dashboard';
            }
        }

        function backToLanding() {
            currentMode = null;
            currentFile = null;
            document.getElementById('landing-page').classList.remove('hidden');
            document.getElementById('dashboard-page').classList.add('hidden');
            document.getElementById('results').classList.add('hidden');
            document.getElementById('upload-status').classList.add('hidden');
            document.getElementById('file-name').textContent = 'Upload Log File';
            
            // Clear risk indicator
            document.getElementById('risk-indicator-container').innerHTML = '';
            
            // Clear AI results
            document.getElementById('ai-results-section').classList.add('hidden');
            document.getElementById('ai-results-content').innerHTML = '';
        }

        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            const chevron = document.getElementById(sectionId + '-chevron');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                chevron.textContent = 'â–¶';
            } else {
                content.classList.add('expanded');
                chevron.textContent = 'â–¼';
            }
        }

        // File upload handler
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('file-input');
            
            fileInput.addEventListener('change', async function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                currentFile = file;
                document.getElementById('file-name').textContent = file.name;
                document.getElementById('loading').classList.remove('hidden');
                document.getElementById('results').classList.add('hidden');
                document.getElementById('upload-status').classList.add('hidden');
                
                // Clear previous results
                document.getElementById('ai-results-section').classList.add('hidden');
                document.getElementById('risk-indicator-container').innerHTML = '';
                
                const formData = new FormData();
                formData.append('file', file);
                
                try {
                    let endpoint, data;
                    
                    if (currentMode === 'ai') {
                        // AI mode: directly call AI endpoint
                        endpoint = '/api/analyze-with-ai';
                        const response = await fetch(endpoint, {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        data = await response.json();
                        
                        if (data.error) {
                            let errorMsg = data.error;
                            if (data.suggestion) {
                                errorMsg += '\n\n' + data.suggestion;
                            }
                            throw new Error(errorMsg);
                        }
                        
                        displayAIResults(data);
                    } else {
                        // Standard mode: call standard endpoint
                        endpoint = '/api/analyze';
                        const response = await fetch(endpoint, {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        data = await response.json();
                        displayResults(data);
                    }
                    
                    document.getElementById('loading').classList.add('hidden');
                    document.getElementById('results').classList.remove('hidden');
                    document.getElementById('upload-status').classList.remove('hidden');
                    
                    // Reset file input to allow re-uploading the same file
                    e.target.value = '';
                    
                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('loading').classList.add('hidden');
                    alert('Error analyzing logs: ' + error.message);
                    // Reset file input
                    e.target.value = '';
                }
            });
        });

        function getCVSSColor(score) {
            if (score >= 9.0) return '#dc2626'; // Critical - red
            if (score >= 7.0) return '#ef4444'; // High - red
            if (score >= 4.0) return '#f59e0b'; // Medium - orange
            if (score >= 0.1) return '#10b981'; // Low - green
            return '#94a3b8'; // None - gray
        }

        function displayResults(data) {
            // Debug: Log the received data
            console.log('Received data:', data);
            console.log('Risk assessment:', data.risk_assessment);
            
            // Display metrics
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = `
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0118 16.5h-2.25m-7.5 0h7.5m-7.5 0l-1 3m8.5-3l1 3m0 0l.5 1.5m-.5-1.5h-9.5m0 0l-.5 1.5m.75-9l3-3 2.148 2.148A12.061 12.061 0 0116.5 7.605" />
                        </svg>
                        <span class="metric-change">+8%</span>
                    </div>
                    <div class="metric-value">${data.parsing_info.total_lines.toLocaleString()}</div>
                    <div class="metric-label">Total Events</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                        </svg>
                        <span class="metric-change">+12%</span>
                    </div>
                    <div class="metric-value">${data.risk_assessment.total_threats}</div>
                    <div class="metric-label">Threats Detected</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                        </svg>
                        <span class="metric-change">-3%</span>
                    </div>
                    <div class="metric-value">${data.ip_analysis.high_risk_ips.length}</div>
                    <div class="metric-label">Blocked IPs</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 01-1.043 3.296 3.745 3.745 0 01-3.296 1.043A3.745 3.745 0 0112 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 01-3.296-1.043 3.745 3.745 0 01-1.043-3.296A3.745 3.745 0 013 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 011.043-3.296 3.746 3.746 0 013.296-1.043A3.746 3.746 0 0112 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 013.296 1.043 3.746 3.746 0 011.043 3.296A3.745 3.745 0 0121 12z" />
                        </svg>
                        <span class="metric-change">+5%</span>
                    </div>
                    <div class="metric-value">${Math.round((data.parsing_info.format_quality.perfect_format / data.parsing_info.total_lines) * 100)}%</div>
                    <div class="metric-label">Format Quality</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                        </svg>
                        <span class="metric-change" style="color: ${getCVSSColor(data.risk_assessment.cvss_aggregate_score || 0)}">${data.risk_assessment.cvss_severity || 'None'}</span>
                    </div>
                    <div class="metric-value" style="color: ${getCVSSColor(data.risk_assessment.cvss_aggregate_score || 0)}">${(data.risk_assessment.cvss_aggregate_score || 0).toFixed(1)}</div>
                    <div class="metric-label">CVSS Score</div>
                </div>
            `;
            
            // Display risk indicator
            const cvssScore = data.risk_assessment.cvss_aggregate_score || 0;
            const cvssSeverity = data.risk_assessment.cvss_severity || 'None';
            const riskLevel = escapeHtml(cvssSeverity.toLowerCase());
            const riskContainer = document.getElementById('risk-indicator-container');
            riskContainer.innerHTML = `
                <div class="risk-indicator ${riskLevel}">
                    <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                    </svg>
                    <span>${escapeHtml(cvssSeverity.toUpperCase())} RISK</span>
                    <div style="width: 1px; height: 1rem; background: var(--neutral-700);"></div>
                    <span>CVSS ${cvssScore.toFixed(1)}</span>
                </div>
            `;
            
            // Display Threat Distribution with CVSS Scores
            const threatsContent = document.getElementById('threats-content');
            document.getElementById('threats-count').textContent = `${data.risk_assessment.total_threats} Total`;
            
            const threatStats = data.threat_statistics;
            let threatsHtml = '<div style="padding: 1rem;"><div style="display: grid; gap: 0.75rem;">';
            
            // Display CVSS scored threats
            if (threatStats.cvss_scores && threatStats.cvss_scores.length > 0) {
                threatStats.cvss_scores.forEach(threat => {
                    const cvssColor = getCVSSColor(threat.cvss_score);
                    threatsHtml += `
                        <div style="background: #0f0f0f; border: 1px solid #262626; padding: 1rem; border-radius: 0.375rem;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                <div>
                                    <div style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.25rem;">${escapeHtml(threat.threat_type)}</div>
                                    <div style="font-size: 0.875rem; color: #737373;">${threat.count} instance${threat.count !== 1 ? 's' : ''} detected</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 1.5rem; font-weight: 600; color: ${cvssColor};">${threat.cvss_score.toFixed(1)}</div>
                                    <div style="font-size: 0.75rem; color: ${cvssColor}; text-transform: uppercase;">${escapeHtml(threat.severity)}</div>
                                </div>
                            </div>
                            <div style="font-size: 0.75rem; color: #525252; font-family: monospace; margin-bottom: 0.5rem;">${escapeHtml(threat.vector_string)}</div>
                            <div style="font-size: 0.875rem; color: #737373; line-height: 1.4;">${escapeHtml(threat.explanation)}</div>
                        </div>
                    `;
                });
            }
            
            threatsHtml += '</div></div>';
            threatsContent.innerHTML = threatsHtml;
            
            // Display IP Analysis
            const ipsContent = document.getElementById('ips-content');
            document.getElementById('ips-count').textContent = `${data.ip_analysis.high_risk_ips.length} Blocked`;
            
            let ipHtml = '<div style="padding: 1rem;"><div style="display: grid; gap: 0.5rem;">';
            data.ip_analysis.high_risk_ips.slice(0, 10).forEach(ip => {
                ipHtml += `
                    <div style="background: #0f0f0f; border: 1px solid #262626; padding: 0.75rem; border-radius: 0.375rem; display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-family: monospace; color: #06b6d4;">${escapeHtml(ip.ip)}</span>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <span style="color: #737373; font-size: 0.875rem;">${ip.count} requests</span>
                            <span style="color: #f87171; font-size: 0.75rem; text-transform: uppercase;">BLOCKED</span>
                        </div>
                    </div>
                `;
            });
            ipHtml += '</div></div>';
            ipsContent.innerHTML = ipHtml;
            
            // Display Parsing Statistics
            const parsingContent = document.getElementById('parsing-content');
            const successRate = ((data.parsing_info.format_quality.perfect_format / data.parsing_info.total_lines) * 100).toFixed(1);
            
            parsingContent.innerHTML = `
                <div style="padding: 1.5rem; display: grid; grid-template-columns: 300px 1fr; gap: 2rem;">
                    <div style="display: flex; align-items: center; justify-content: center;">
                        <div style="position: relative; width: 200px; height: 200px;">
                            <svg viewBox="0 0 200 200" style="transform: rotate(-90deg);">
                                <circle cx="100" cy="100" r="80" fill="none" stroke="#262626" stroke-width="20"/>
                                <circle cx="100" cy="100" r="80" fill="none" stroke="#06b6d4" stroke-width="20"
                                    stroke-dasharray="${(successRate / 100) * 502.4} 502.4" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                <div style="font-size: 2rem; font-weight: 600;">${successRate}%</div>
                                <div style="font-size: 0.875rem; color: #737373;">Success Rate</div>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem; justify-content: center;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: #a3a3a3;">Authentication Events</span>
                            <span style="font-weight: 600;">4521</span>
                            <div style="flex: 1; margin: 0 1rem; height: 6px; background: #262626; border-radius: 3px; overflow: hidden;">
                                <div style="height: 100%; width: 75%; background: #06b6d4;"></div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: #a3a3a3;">Network Traffic</span>
                            <span style="font-weight: 600;">3892</span>
                            <div style="flex: 1; margin: 0 1rem; height: 6px; background: #262626; border-radius: 3px; overflow: hidden;">
                                <div style="height: 100%; width: 65%; background: #06b6d4;"></div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: #a3a3a3;">System Access</span>
                            <span style="font-weight: 600;">2569</span>
                            <div style="flex: 1; margin: 0 1rem; height: 6px; background: #262626; border-radius: 3px; overflow: hidden;">
                                <div style="height: 100%; width: 43%; background: #06b6d4;"></div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: #a3a3a3;">File Operations</span>
                            <span style="font-weight: 600;">1865</span>
                            <div style="flex: 1; margin: 0 1rem; height: 6px; background: #262626; border-radius: 3px; overflow: hidden;">
                                <div style="height: 100%; width: 31%; background: #06b6d4;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Store data for later use
            window.analysisData = data;
        }

        function displayAIResults(data) {
            // First display metrics
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = `
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0118 16.5h-2.25m-7.5 0h7.5m-7.5 0l-1 3m8.5-3l1 3m0 0l.5 1.5m-.5-1.5h-9.5m0 0l-.5 1.5m.75-9l3-3 2.148 2.148A12.061 12.061 0 0116.5 7.605" />
                        </svg>
                        <span class="metric-change">+8%</span>
                    </div>
                    <div class="metric-value">${data.total_logs.toLocaleString()}</div>
                    <div class="metric-label">Total Events</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                        </svg>
                        <span class="metric-change">+12%</span>
                    </div>
                    <div class="metric-value">${data.suspicious_logs}</div>
                    <div class="metric-label">Threats Detected</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                        </svg>
                        <span class="metric-change">-3%</span>
                    </div>
                    <div class="metric-value">${data.suspicious_logs}</div>
                    <div class="metric-label">Blocked IPs</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <svg class="icon" fill="none" stroke="var(--neutral-500)" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 01-1.043 3.296 3.745 3.745 0 01-3.296 1.043A3.745 3.745 0 0112 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 01-3.296-1.043 3.745 3.745 0 01-1.043-3.296A3.745 3.745 0 013 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 011.043-3.296 3.746 3.746 0 013.296-1.043A3.746 3.746 0 0112 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 013.296 1.043 3.746 3.746 0 011.043 3.296A3.745 3.745 0 0121 12z" />
                        </svg>
                        <span class="metric-change">+5%</span>
                    </div>
                    <div class="metric-value">100%</div>
                    <div class="metric-label">Format Quality</div>
                </div>
            `;
            
            // Display risk indicator based on threat level
            const threatLevel = escapeHtml(data.report.threat_level.toLowerCase());
            const riskLevel = threatLevel.includes('critical') ? 'critical' : 
                            threatLevel.includes('high') ? 'high' :
                            threatLevel.includes('medium') ? 'medium' : 'low';
            const riskContainer = document.getElementById('risk-indicator-container');
            riskContainer.innerHTML = `
                <div class="risk-indicator ${riskLevel}">
                    <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                    </svg>
                    <span>${escapeHtml(data.report.threat_level.toUpperCase())}</span>
                    <div style="width: 1px; height: 1rem; background: var(--neutral-700);"></div>
                    <span>${escapeHtml(data.suspicious_logs.toString())}/100</span>
                </div>
            `;
            
            const section = document.getElementById('ai-results-section');
            const display = document.getElementById('ai-results-content');
            
            let html = `
                <div style="background: var(--neutral-900); border: 1px solid var(--neutral-800); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                    <h3 style="color: var(--purple-400); margin-bottom: 0.75rem; font-size: 1rem;">ðŸ“‹ Executive Summary</h3>
                    <p style="color: var(--neutral-300); line-height: 1.6;">${escapeHtml(data.report.summary)}</p>
                    <div style="margin-top: 0.75rem; padding: 0.75rem; background: var(--neutral-800); border-radius: 0.375rem;">
                        <strong style="color: var(--neutral-100);">Threat Level:</strong> 
                        <span style="color: var(--red-400); font-weight: 600; font-size: 1.1rem;">${escapeHtml(data.report.threat_level)}</span>
                    </div>
                    <div style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--neutral-400);">
                        ðŸ“Š Analyzed ${escapeHtml(data.total_logs.toString())} logs | ðŸš¨ ${escapeHtml(data.suspicious_logs.toString())} suspicious
                    </div>
                </div>
            `;
            
            // Findings
            if (data.report.findings && data.report.findings.length > 0) {
                html += `<div style="background: var(--neutral-900); border: 1px solid var(--neutral-800); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                    <h3 style="color: var(--purple-400); margin-bottom: 0.75rem; font-size: 1rem;">ðŸ” Key Findings (${data.report.findings.length})</h3>`;
                
                data.report.findings.forEach((finding, i) => {
                    html += `<div style="background: var(--neutral-800); border-left: 3px solid var(--purple-400); padding: 0.75rem; margin-bottom: 0.75rem; border-radius: 0.25rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600; color: var(--neutral-100);">${i + 1}. ${escapeHtml(finding.attack_type)}</span>
                            <span style="font-size: 0.75rem; color: var(--cyan-400); font-weight: 600;">${Math.round(finding.confidence * 100)}% confidence</span>
                        </div>
                        <div style="color: var(--neutral-400); font-size: 0.875rem; margin-bottom: 0.5rem;">
                            <strong>Severity:</strong> <span style="color: var(--red-400);">${escapeHtml(finding.severity)}</span>
                        </div>
                        <div style="color: var(--neutral-300); line-height: 1.5; font-size: 0.875rem;">
                            ${escapeHtml(finding.description)}
                        </div>
                    </div>`;
                });
                
                html += `</div>`;
            }
            
            // Recommendations
            if (data.report.recommendations && data.report.recommendations.length > 0) {
                html += `<div style="background: var(--neutral-900); border: 1px solid var(--neutral-800); border-radius: 0.5rem; padding: 1rem;">
                    <h3 style="color: var(--purple-400); margin-bottom: 0.75rem; font-size: 1rem;">ðŸ’¡ Recommendations</h3>
                    <ul style="color: var(--neutral-300); line-height: 1.8; padding-left: 1.25rem;">`;
                
                data.report.recommendations.forEach(rec => {
                    html += `<li>${escapeHtml(rec)}</li>`;
                });
                
                html += `</ul></div>`;
            }
            
            display.innerHTML = html;
            section.classList.remove('hidden');
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>
</body>
</html>
